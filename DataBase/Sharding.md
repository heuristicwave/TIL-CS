## Sharding

데이터베이스의 수평적 확장, 대규모 데이터베이스를 Shard라고 부르는 작은 단위로 분할하는 기술. 모든 샤드는 같은 스키마를 쓰지만 샤드에 보과노디는 데이터 사이에는 중복이 없다.



사용자테이터를 어느 샤드에 넣을지는 사용자 ID에 따라 정하며, 샤딩 키를 어떻게 정하느냐가 중요하다. 샤딩 키는 파티션 키라고도 부른다.

- Resharding : 데이터가 너무 많아져서 하나의 샤드로는 더 이상 감당하기 어려울 때

  샤드간 데이터 분포가 균등하지 못해 어떤 샤드에 할당된 공간 소모가 다른 샤드에 비해 빨리 진행될 때, shard exhaustion 발생. (샤드 키를 계산하는 함수를 변경하고 데이터를 재배치 - 안정 해시 기법)

- Celebrity 문제(hotspot key) : 특정 샤드에 질의가 집중되어 서버에 과부하가 걸리는 문제. Ex) 특정 유명인사만 조회

- Join & Denormalization : 하나의 DB가 여러개로 쪼개지면, 여러 샤드에 걸친 데이터를 조인하기가 힘들다. (데이터를 비정규화해 하나의 테이블에서 질의가 수행될 수 있도록)

