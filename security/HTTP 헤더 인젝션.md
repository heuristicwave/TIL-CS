## 웹 프로그램 취약점

### HTTP 헤더 인젝션

공격자가 줄바꿈 코드 등을 삽입해 임의의 응답 헤더 필드나 바디를 추가할 수 있는 취약점

공격을 위해서는 피해자의 개입이 있어야 하는 수동적인 공격으로 분류된다.

- 임의의 URL에 리다이렉트를 시킬 수 있다는 점을 악용해 악성 사이트로 유도 가능
- 모든 쿠키를 생성할 수 있기에 세션 고정 공격에 이용
- 임의의 HTTP 바디가 생성되므로 웹 페이지에 표시된 내용을 변조시킴



#### HTTP 헤더 인젝션 동작 예

```
http://example.com/location.cgi?cat=%0D%0ALocation:%20http://hack.com
```

`%0D%0A`는 http 메시지에서 줄 바꿈을 나타낸다.

location 필드가 2개이지만 웹서버 아파치는 복수의 location헤더 필드를 송신한 경우 마지막에 있는 location 헤더 필드만 반환하여 공격자가 지정한 주소로 리다이렉트 된다.



#### HTTP 응답 분할 공격

HTTP 헤더 인젝션을 응용한 공격. 여러 개의 HTTP 응답을 만늘어 냄으로써 캐서버나 프록시 서버에 변조된 콘텐츠를 전송해 다른 사용자에게 영향을 줌

HTTP/1.1에서는 여러개의 요청을 보내는 경우 한번에 응답을 하는 기능이 있다. 이것을 악용하여 응답을 강제로 만든다.



#### 메일 헤더 인젝션

메일 메시지의 헤더 부분에 공격자가 줄  바꿈 코드 등을 삽입해 임의의 헤더 필드나 바디를 추가시켜 발생하는 취약점



### 크로스 사이트 스크립트(XSS)

공격자가 설치한 함정에 빠져 브라우저에 악의적인 HTML태그나 자바스크립트를 실행시킴

- Reflected XSS : 공격용 스크립트가 웹 페이지에 저장되지 않고 매개변수 등을 통해 전달돼 실행
- Stores XSS : 공격용 스크립트가 공격 대상 웹 페이지의 DB등에 저장되는 경우



### 세션 관리 미비

웹 프로그램에서는 인증 상태를 관리하기 위해 세션 관리 기능을 사용하지만, 제대로 구현되지 않으면 세션ID가 탈취되거나 정보가 노출된다.



#### 세션 고정

공격자가 지정한 세션id를 사용자가 사용하게끔 만드는 취약점

공격자가 인증에 사용한 세션 ID를 저장해 피해자가 접근하도록 유도하여 저장된 세션으로 로그인 시키면, 공격자는 사용자가 로그인 했을 때를 추측해 공격에 사용한 세션으로 접속한다.



#### 사이트 간 요청 변조(CSRF)

로그인 중에 사용자가 강제적으로 요청을 보내게끔 유도해 해당 권한으로 기능을 조작하도록 만드는 취약점이다.



#### 쿠키에 HttpOnly 속성 미설정

HttpOnly 속성 설정을 하지 않으면 자바스크립트를 통해 쿠키에 접근 할 수 있다.

XSS 취약점이 있어도 세션 ID는 유출되지 않는다.

```javascript
// 속성을 설정한 set-cookie 헤더 필드
Set-Cookie: SESSID=123123afg1; Path=/; HttpOnly

// 속성을 설정하지 않은 set-cookie 헤더 필드
Set-Cookie: SESSID=123123afg1; Path=/
```



#### 추측가능한 세션 ID

세션 ID를 생성하는 알고리즘이 단순하게 구현되면 쉽게 추측이 가능함



### 정보 노출

- 매개변수를 통한 정보 노출
- 캐시로부터의 정보 노출
- 패스워드 필드의 마스킹 미흡
- 에러 메시지를 통한 정보 노출
- 민감 정보 노출
- https를 사용 시 secure 속성이 없이 구성된 쿠키 정보
- 부적절한 https
- 불필요한 정보 저장



#### 경로 탐색



#### 오픈 리다이렉트

리다이렉트 기능을 악용해 악성 사이트 유도

#### 원격 파일 참조

스크립트의 일부를 다른 파일에서 참조하여 공격자가 지정한 외부 서버를 읽어 임의의 스크립트 실행

#### 클릭재킹

투명한 레이어로 공격자가 설정한 페이지로 이동

---

본 내용은 `우에노 센 - 웹보안 담당자를 위한 취약점 진단 스타트 가이드`를 보고 정리한 내용입니다.