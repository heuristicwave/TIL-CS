## 웹 프로그램 취약점

### HTTP 헤더 인젝션

공격자가 줄바꿈 코드 등을 삽입해 임의의 응답 헤더 필드나 바디를 추가할 수 있는 취약점

공격을 위해서는 피해자의 개입이 있어야 하는 수동적인 공격으로 분류된다.

- 임의의 URL에 리다이렉트를 시킬 수 있다는 점을 악용해 악성 사이트로 유도 가능
- 모든 쿠키를 생성할 수 있기에 세션 고정 공격에 이용
- 임의의 HTTP 바디가 생성되므로 웹 페이지에 표시된 내용을 변조시킴



#### HTTP 헤더 인젝션 동작 예

```
http://example.com/location.cgi?cat=%0D%0ALocation:%20http://hack.com
```

`%0D%0A`는 http 메시지에서 줄 바꿈을 나타낸다.

location 필드가 2개이지만 웹서버 아파치는 복수의 location헤더 필드를 송신한 경우 마지막에 있는 location 헤더 필드만 반환하여 공격자가 지정한 주소로 리다이렉트 된다.



#### HTTP 응답 분할 공격

HTTP 헤더 인젝션을 응용한 공격. 여러 개의 HTTP 응답을 만늘어 냄으로써 캐서버나 프록시 서버에 변조된 콘텐츠를 전송해 다른 사용자에게 영향을 줌

HTTP/1.1에서는 여러개의 요청을 보내는 경우 한번에 응답을 하는 기능이 있다. 이것을 악용하여 응답을 강제로 만든다.



#### 메일 헤더 인젝션

메일 메시지의 헤더 부분에 공격자가 줄  바꿈 코드 등을 삽입해 임의의 헤더 필드나 바디를 추가시켜 발생하는 취약점



### 크로스 사이트 스크립트(XSS)

공격자가 설치한 함정에 빠져 브라우저에 악의적인 HTML태그나 자바스크립트를 실행시킴

- Reflected XSS : 공격용 스크립트가 웹 페이지에 저장되지 않고 매개변수 등을 통해 전달돼 실행
- Stores XSS : 공격용 스크립트가 공격 대상 웹 페이지의 DB등에 저장되는 경우





---

본 내용은 `우에노 센 - 웹보안 담당자를 위한 취약점 진단 스타트 가이드`를 보고 정리한 내용입니다.