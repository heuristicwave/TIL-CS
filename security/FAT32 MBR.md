### FAT32



55 AA 앞 64바이트(4줄)가 파티션엔트리

EBR 계산은 상대 위치

https://m.blog.naver.com/PostView.nhn?blogId=aaaa8229&logNo=220847720912&proxyReferer=https%3A%2F%2Fwww.google.com%2F

https://manggong.org/37



EBR 뒤에 EBR도 MBR 기준으로 상대주소 계산



```
00 02 03 00 07 11 0E 03 80 00 00 00 00 C0 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
```

하나만 씀 즉, 더 이상의 파티션은 없음

---

### Find Partition Hans-On



#### 0번째 섹터 - MBR

```
00020300078E0C028000000000A00000 - partition 1(16Bytes)
008E0D02071B160580A0000000A00000 - partition 2(16Bytes)
001B170507A720078040010000A00000 - partition 3(16Bytes)
00A7210705FE3F0F80E0010000100200 - partition 4(16Bytes)
55AA
```

> First Partition Entry
>
> ```
> 00
> 02 03 00
> 07
> 8E 0C 02
> 80 00 00 00
> 00 A0 00 00
> ```
>
> ```
> # 엔디안 적용
> 80
> A0 00
> ```
>
> 80 * 200 = 10000
>
> A000 * 200 = 140 0000
>
> 첫번째 ntfs의 섹터 주소 : 10000 + 140 0000 = 141 0000

> Second Partition Entry
>
> ```
> 00
> 8E 0D 02
> 07
> 1B 16 05 
> 80 A0 00 00 
> 00 A0 00 00
> ```
>
> ```
> # 엔디안 적용
> A0 80
> A0 00
> ```
>
> A0 80 * 200 = 141 0000
>
> A0 00 * 200 = 140 0000
>
> 두번째 ntfs의 섹터 주소 : 141 0000 + 140 0000 = 281 0000

> Third Partition Entry
>
> ```
> 00
> 1B 17 05 
> 07
> A7 20 07 
> 80 40 01 00 
> 00 A0 00 00
> ```
>
> ```
> # 엔디안 적용
> 01 40 80
> A0 00
> ```
>
> 01 40 80 * 200 = 281 0000
>
> A0 00 * 200 = 140 0000
>
> 세번째 ntfs의 섹터 주소 : 281 0000 + 140 0000 = 3C1 0000



##### 필요한 정보 추출 (partition 4)

```
00 (부팅 가능 여부)
A7 21 07 (파티션의 위치를 CHS 방식으로 표현 - C:실린더, H:헤더, S:섹터)
05 (File system type : EBR)
FE 3F 0F (파티션이 끝 지점을 CHS방식으로 표현)
80 E0 01 00 (파티션의 시작 지점)
00 10 02 00 (파티션의 사이즈)
```



##### Little Endian 적용

```
(파티션의 시작 지점) 00 01 E0 80   
(파티션의 사이즈) 00 02 10 00 
```

1 E080‬(123,008 - decimal) X 200 = 3C1 0000‬

02 1000 X 200 = 420 0000‬

7E1 0000‬



##### 3C1 0000‬ 이동 - First EBR

````
00020300078E0C028000000000A00000
008E0D02051D180580A0000080A00000
00000000000000000000000000000000
00000000000000000000000000000000
````



##### 필요한 정보 추출

```
# NTFS 확인
00
02 03 00
07 (NTFS)
8E 0C 02 
80 00 00 00 
00 A0 00 00

# EBR 확인
00
8E 0D 02 
05
1D 18 05 
80 A0 00 00
80 A0 00 00
```



##### Little Endian 적용

```
# NEXT NTFS
80
A0 00

# NEXT EBR
(파티션의 시작 지점) 00 00 A0 80   
(파티션의 사이즈) 00 00 A0 80 
```

NEXT NTFS :  80‬(hex) X 200‬(hex) = 10000

> 네번째 : 3C1 0000‬ + 10000 = 3C2 0000

NEXT EBR : A0 80‬(hex) X 200‬(hex) = 141 0000‬



##### Second EBR 구하기 : 상대 주소 처리

첫 EBR  + 두번째 EBR로 가기위한 값

3C1 0000‬ + 141 0000‬ = 502 0000



502 0000가 안나오니, 501ff0앞 50201f0 앞을 보고 07 혹은 05를 찾는다

```
000D0A5072657373204374726C2B416C
742B44656C20746F2072657374617274
0D0A0000000000000000000000000000
00000000000000008A01A701BF010000
501ff0 -------------------------

00020300078E0C028000000000A00000
001D1905052E26080041010080C00000
00000000000000000000000000000000
00000000000000000000000000000000
50201f0 ------------------------
```



#### Third EBR 분석 - 05가 들어간 파티션 엔트리 분석

```
00
1D 19 05
05
2E 26 08
00 41 01 00
80 C0 00 00
```

> 다섯번째 NTFS 위치 파악하기
>
> ```
> 00
> 02 03 00 
> 07 
> 8E 0C 02 
> 80 00 00 00 
> 00 A0 00 00
> ```
>
> ```
> #엔디안 적용
> 80
> A0 00
> ```
>
> NEXT NTFS :  80‬(hex) X 200‬(hex) = 10000
>
> 5020000(Third EBR = 첫 EBR  + 두번째 EBR) + 10000 = 503 0000 (다섯번째 NTFS의 시작주소)



##### Little Endian 적용

```
(파티션의 시작 지점) 00 01 41 00   
(파티션의 사이즈) 00 00 c0 80 
```

// c0‬80(hex) X 200‬(hex) = 181 0000‬ [실수]

14100 X 200‬(hex) = 282 0000‬



 3C1 0000‬ + 282 0000‬ = 643 0000‬



##### 6번째 NTFS 이동

```
00
02 03 00
07
11 0E 03 
80 00 00 00 
00 C0 00 00
```



##### Little Endian 적용

```
(파티션의 시작 지점) 00 00 00 80   
(파티션의 사이즈) 00 00 c0 00 
```

80(hex) X 200‬(hex) = 1 0000‬

643 0000‬ + 1 0000‬ = 6440000 (여섯번째 NTFS의 시작주소)



> 642fe00에 NTFS 위치 이건 뭐지?